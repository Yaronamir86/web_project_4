!function(){"use strict";function e(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class t{constructor(t){e(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),e(this,"_handleOverlayClose",(e=>{e.target.classList.contains("modal")&&this.close()})),this._popupElement=document.querySelector(t),this.close=this.close.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("click",this._handleOverlayClose),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("click",this._handleOverlayClose),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popupElement.querySelector(".modal__close-btn").addEventListener("click",this.close)}}class s extends t{constructor(e,t){var s,i;super(e),i=()=>{super.close(),this._formElement.reset()},(s="close")in this?Object.defineProperty(this,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[s]=i,this._formElement=this._popupElement.querySelector(".form"),this._inputList=[...this._formElement.querySelectorAll(".form__input")],this._submitHandler=t,this._submitButton=this._formElement.querySelector(".form__button"),this._submitButtonText=this._submitButton.textContent}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}setEventListeners(){this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler(this._getInputValues())})),super.setEventListeners()}}class i{constructor(e,t,s,i,n,r){var o,a;a=()=>document.querySelector(this._selector).content.querySelector(".element__list-item").cloneNode(!0),(o="_getTemplateClone")in this?Object.defineProperty(this,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):this[o]=a,this._text=e.name,this._link=e.link,this._selector=t,this._handleCardClick=s,this._handleDeleteCard=i,this._handleLikeIcon=n,this._id=e._id,this._userId=r,this._ownerId=e.owner._id,this._likes=e.likes,this._likeCount=e.likes}getId(){return this._id}removeCard(){this._element.remove(),this._element=null}_setEventListeners(){this._likeButton.addEventListener("click",(()=>this._handleLikeIcon(this._id))),this._deleteButton.addEventListener("click",(()=>this._handleDeleteCard(this._id))),this._image.addEventListener("click",(e=>this._handleCardClick(e)))}setLikes(e){this._likes=e;const t=this._likes.length;this._likeCount.textContent=t,this.isLiked()?this._likeButton.classList.add("element__like-btn_active"):this._likeButton.classList.remove("element__like-btn_active")}isLiked(){return this._likes.find((e=>e._id===this._userId))}generateCard(){return this._element=this._getTemplateClone(),this._image=this._element.querySelector(".element__photo"),this._image.src=this._link,this._image.alt="A beautiful scene in ".concat(this._text),this._deleteButton=this._element.querySelector(".element__trash-btn"),this._likeButton=this._element.querySelector(".element__like-btn"),this._likeCount=this._element.querySelector(".element__like-count"),this._element.querySelector(".element__title").textContent=this._text,this._ownerId!==this._userId&&(this._deleteButton.style.display="none"),this.setLikes(this._likes),this._setEventListeners(),this._element}}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class r{constructor(e,t){n(this,"_showInputError",((e,t)=>{const s=this._form.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)})),n(this,"_hideInputError",(e=>{const t=this._form.querySelector(".".concat(e.id,"-error"));t.textContent="",t.classList.remove(this._errorClass),e.classList.remove(this._inputErrorClass)})),n(this,"_checkInputValidity",(e=>{e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)})),n(this,"_hasInvalidInputs",(()=>this._inputList.some((e=>!e.validity.valid)))),n(this,"enableButton",(()=>{this._button.disabled=!1,this._button.classList.remove(this._inactiveButtonClass)})),n(this,"_disableButton",(()=>{this._button.disabled=!0,this._button.classList.add(this._inactiveButtonClass)})),n(this,"_toggleButton",(()=>{this._hasInvalidInputs()?this._disableButton():this.enableButton()})),n(this,"_setEventListeners",(()=>{this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._button=this._form.querySelector(this._submitButtonSelector),this._toggleButton(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButton()}))}))})),this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}resetValidation(){this._disableButton()}enableValidation(){this._form.addEventListener("submit",(e=>e.preventDefault())),this._setEventListeners()}hideErrors(){this._inputList.forEach((e=>{this._hideInputError(e)}))}}const o={inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"},a=(document.querySelector(".element__list"),document.querySelector(".form_type_profile")),l=document.querySelector(".profile__edit-btn"),c=document.querySelector(".profile__add-btn"),h=document.querySelector(".form__input_type_name"),_=document.querySelector(".form__input_type_about-me"),d=document.querySelector(".form_type_place"),u=document.querySelector(".form_type_avatar"),m=document.querySelector(".profile__avatar-container");document.querySelector(".profile__avatar"),document.querySelector(".element__trash-btn");const p=new class{constructor(e){let{baseUrl:t,headers:s}=e;var i,n;n=(e,t)=>fetch(e,t).then((e=>e.ok?e.json():Promise.reject(e.statusText))),(i="_customFetch")in this?Object.defineProperty(this,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[i]=n,this._baseUrl=t,this._headers=s}getInitialCards(){return this._customFetch("".concat(this._baseUrl,"/cards"),{headers:this._headers})}getUserInfo(){return this._customFetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers})}editProfile(e,t){return this._customFetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers,method:"PATCH",body:JSON.stringify({name:e,about:t})})}editAvatar(e){return this._customFetch("".concat(this._baseUrl,"/users/me/avatar"),{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})})}createCards(e){return this._customFetch("".concat(this._baseUrl,"/cards"),{headers:this._headers,method:"POST",body:JSON.stringify(e)})}deleteCards(e){return this._customFetch("".concat(this._baseUrl,"/cards/").concat(e),{headers:this._headers,method:"DELETE"})}addLike(e){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"PUT"})}removeLike(e){return this._customFetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{headers:this._headers,method:"DELETE"})}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"a42b1115-c728-4ed0-ac26-3d3a2cd8e95d","Content-Type":"application/json"}}),v=new s(".modal_type_edit-profile",(e=>{v.renderLoading(!0,"saving..."),p.editProfile(e.user,e.about).then((e=>{q.setUserInfo(e.name,e.about),v.close()})).catch((e=>console.log(e))).finally((()=>v.renderLoading(!1)))}));v.setEventListeners();const b=new s(".modal_type_place",(e=>{b.renderLoading(!0,"Creating..."),p.createCards({name:e.Title,link:e["Image link"]}).then((e=>{k(e),b.close()})).catch((e=>console.log(e))).finally((()=>b.renderLoading(!1)))}));b.setEventListeners();const f=new s(".modal_type_avatar",(e=>{f.renderLoading(!0,"saving..."),p.editAvatar(e["Image link"]).then((e=>{q.setAvatarInfo(e.avatar),f.close()})).catch((e=>console.log(e))).finally((()=>f.renderLoading(!1)))}));f.setEventListeners();const y=new class extends t{constructor(e){super(e),this._imageElemant=this._popupElement.querySelector(".modal__image_type_preview"),this._imageCaption=this._popupElement.querySelector(".modal__title_type_preview")}open(e,t){this._imageElemant.src=e,this._imageElemant.alt="A beautiful view of ".concat(t),this._imageCaption.textContent=t,super.open()}}(".modal_type_preview");y.setEventListeners();const E=new class extends t{setAction(e){this._submitHandler=e}setEventListeners(){this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._submitHandler()})),super.setEventListeners()}}(".modal_type_delete");let L;E.setEventListeners(),Promise.all([p.getInitialCards(),p.getUserInfo()]).then((e=>{let[t,s]=e;L=s._id,g.render(t),q.setUserInfo(s.name,s.about),q.setAvatarInfo(s.avatar)})).catch((e=>console.log(e)));const g=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}render(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:k},".element__list");function k(e){const t=function(e){const t=new i(e,"#card-template",(()=>{y.open(e.link,e.name)}),(e=>{E.open(),E.setAction((()=>{p.deleteCards(e).then((e=>{t.removeCard(),E.close()})).catch((e=>console.log(e)))}))}),(()=>{t.isLiked()?p.removeLike(t.getId()).then((e=>{t.setLikes(e.likes)})).catch((e=>console.log(e))):p.addLike(t.getId()).then((e=>{t.setLikes(e.likes)})).catch((e=>console.log(e)))}),L);return t.generateCard(e)}(e);g.addItem(t)}const C=new r(o,a),S=new r(o,d),I=new r(o,u);S.enableValidation(),C.enableValidation(),I.enableValidation();const q=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:i}=e;this._profileName=document.querySelector(t),this._profileJob=document.querySelector(s),this._avatar=document.querySelector(i)}getUserInfo(){return{name:this._profileName.textContent,job:this._profileJob.textContent}}setUserInfo(e,t){this._profileName.textContent=e,this._profileJob.textContent=t}setAvatarInfo(e){this._avatar.src=e}}({nameSelector:".profile__name",jobSelector:".profile__about",avatarSelector:".profile__avatar"});l.addEventListener("click",(()=>{const e=q.getUserInfo();h.value=e.name,_.value=e.job,C.enableButton(),C.hideErrors(),v.open()})),c.addEventListener("click",(()=>{b.open(),S.resetValidation(),S.hideErrors()})),m.addEventListener("click",(()=>{f.open(),I.resetValidation(),I.hideErrors()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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aUJBQ2RDLFlBQWEsa0JBQ2JDLGVBQWdCLHFCQU9sQjdFLEVBQWtCNUcsaUJBQWlCLFNBQVMsS0FDMUMsTUFBTThMLEVBQU81QyxFQUFTZixjQUN0QnJCLEVBQVV4RixNQUFRd0ssRUFBS3pLLEtBQ3ZCMEYsRUFBV3pGLE1BQVF3SyxFQUFLRCxJQUN4QlQsRUFBa0J4RixlQUNsQndGLEVBQWtCMUUsYUFDbEJ1QyxFQUFhbkosVUFHZitHLEVBQWlCN0csaUJBQWlCLFNBQVMsS0FDekN5SixFQUFXM0osT0FDWHVMLEVBQXFCN0Usa0JBQ3JCNkUsRUFBcUIzRSxnQkFHdkJRLEVBQU9sSCxpQkFBaUIsU0FBUyxLQUMvQjJKLEVBQVk3SixPQUNad0wsRUFBb0I5RSxrQkFDcEI4RSxFQUFvQjVFLGdCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5jbG9zZSA9IHRoaXMuY2xvc2UuYmluZCh0aGlzKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVPdmVybGF5Q2xvc2UpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVPdmVybGF5Q2xvc2UpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgLy9zdG9yZXMgdGhlIGxvZ2ljIGZvciBjbG9zaW5nIHRoZSBwb3B1cCBieSBwcmVzc2luZyB0aGUgRXNjIGtleS5cclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBfaGFuZGxlT3ZlcmxheUNsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy9hZGRzIGEgY2xpY2sgZXZlbnQgbGlzdGVuZXIgdG8gdGhlIGNsb3NlIGljb24gb2YgdGhlIHBvcHVwLlxyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmNsb3NlKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvciwgc3VibWl0SGFuZGxlcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX19pbnB1dFwiKV07XHJcbiAgICB0aGlzLl9zdWJtaXRIYW5kbGVyID0gc3VibWl0SGFuZGxlcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIC8vY29sbGVjdHMgZGF0YSBmcm9tIGFsbCB0aGUgaW5wdXQgZmllbGRzIGFuZCByZXR1cm5zIHRoYXQgZGF0YSBhcyBhbiBvYmplY3QuXHJcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRIYW5kbGVyKHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgICAvL3RoaXMuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbiAgXHJcbiAgY2xvc2UgPSAoKSA9PiB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQucmVzZXQoKTtcclxuICB9O1xyXG59XHJcbiIsImV4cG9ydCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGRhdGEsXHJcbiAgICBzZWxlY3RvcixcclxuICAgIGhhbmRsZUNhcmRDbGljayxcclxuICAgIGhhbmRsZURlbGV0ZUNhcmQsXHJcbiAgICBoYW5kbGVMaWtlSWNvbixcclxuICAgIHVzZXJJZFxyXG4gICkge1xyXG4gICAgdGhpcy5fdGV4dCA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcblxyXG4gICAgdGhpcy5fc2VsZWN0b3IgPSBzZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQgPSBoYW5kbGVEZWxldGVDYXJkO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUljb24gPSBoYW5kbGVMaWtlSWNvbjtcclxuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XHJcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcbiAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XHJcbiAgICB0aGlzLl9saWtlcyA9IGRhdGEubGlrZXM7XHJcbiAgICB0aGlzLl9saWtlQ291bnQgPSBkYXRhLmxpa2VzXHJcbiAgfVxyXG5cclxuICBnZXRJZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pZDtcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZUNsb25lID0gKCkgPT4ge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9zZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5lbGVtZW50X19saXN0LWl0ZW1cIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcclxuICB9O1xyXG5cclxuICByZW1vdmVDYXJkKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcclxuXHJcbiAgICB0aGlzLl9lbGVtZW50ID0gbnVsbDtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VJY29uKHRoaXMuX2lkKVxyXG4gICAgKTtcclxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCh0aGlzLl9pZClcclxuICAgICk7XHJcbiAgICB0aGlzLl9pbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGRhdGEpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayhkYXRhKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHNldExpa2VzKG5ld0xpa2VzKSB7XHJcbiAgICB0aGlzLl9saWtlcyA9IG5ld0xpa2VzO1xyXG5cclxuICAgIGNvbnN0IGxpa2VBbW91bnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcbiAgICB0aGlzLl9saWtlQ291bnQudGV4dENvbnRlbnQgPVxyXG4gICAgICBsaWtlQW1vdW50O1xyXG5cclxuICAgIGNvbnN0IGNhcmRJc0xpa2VkQnlDdXJyZW50VXNlciA9IHRoaXMuaXNMaWtlZCAoKVxyXG5cclxuICAgIGlmKGNhcmRJc0xpa2VkQnlDdXJyZW50VXNlcikge1xyXG4gICAgICB0aGlzLl9saWtlQnV0dG9uXHJcbiAgICAgICAgLmNsYXNzTGlzdC5hZGQoXCJlbGVtZW50X19saWtlLWJ0bl9hY3RpdmVcIik7XHJcbiAgICB9ZWxzZXtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvblxyXG4gICAgICAgIC5jbGFzc0xpc3QucmVtb3ZlKFwiZWxlbWVudF9fbGlrZS1idG5fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgaXNMaWtlZCAoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fbGlrZXMuZmluZChcclxuICAgICAgKHVzZXIpID0+IHVzZXIuX2lkID09PSB0aGlzLl91c2VySWRcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGVDbG9uZSgpO1xyXG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fcGhvdG9cIik7XHJcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gYEEgYmVhdXRpZnVsIHNjZW5lIGluICR7dGhpcy5fdGV4dH1gO1xyXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX3RyYXNoLWJ0blwiKTtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fbGlrZS1idG5cIik7XHJcbiAgICB0aGlzLl9saWtlQ291bnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fbGlrZS1jb3VudFwiKTtcclxuXHJcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fdGl0bGVcIikudGV4dENvbnRlbnQgPSB0aGlzLl90ZXh0O1xyXG4gICAgdGhpcy5fb3duZXJJZCAhPT0gdGhpcy5fdXNlcklkICYmXHJcbiAgICAgICh0aGlzLl9kZWxldGVCdXR0b24uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiKTtcclxuXHJcbiAgICB0aGlzLnNldExpa2VzKHRoaXMuX2xpa2VzKTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG5cclxuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvciA9IChpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkgPT4ge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfTtcclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yID0gKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gIH07XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkgPSAoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXRzID0gKCkgPT5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+ICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xyXG5cclxuICBlbmFibGVCdXR0b24gPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9idXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIHRoaXMuX2J1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIH07XHJcblxyXG4gIF9kaXNhYmxlQnV0dG9uID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fYnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIHRoaXMuX2J1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIH07XHJcblxyXG4gIF90b2dnbGVCdXR0b24gPSAoKSA9PiB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0cygpKSB7XHJcbiAgICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuZW5hYmxlQnV0dG9uKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzID0gKCkgPT4ge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXHJcbiAgICApO1xyXG4gICAgdGhpcy5fYnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuXHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b24oKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiBldnQucHJldmVudERlZmF1bHQoKSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxuXHJcbiAgaGlkZUVycm9ycygpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgaW5wdXRTZWxlY3RvcjogXCIuZm9ybV9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIuZm9ybV9fYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJmb3JtX19idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwiZm9ybV9fZXJyb3JfdmlzaWJsZVwiLFxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHBsYWNlc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2xpc3RcIik7XHJcbmV4cG9ydCBjb25zdCBjYXJkVGVtcGxhdGVTZWxlY3RvciA9IFwiI2NhcmQtdGVtcGxhdGVcIjtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtX3R5cGVfcHJvZmlsZVwiKTtcclxuZXhwb3J0IGNvbnN0IGVkaXRQcm9maWxlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ0blwiKTtcclxuZXhwb3J0IGNvbnN0IGFkZFByb2ZpbGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idG5cIik7XHJcbmV4cG9ydCBjb25zdCBpbnB1dE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0X3R5cGVfbmFtZVwiKTtcclxuZXhwb3J0IGNvbnN0IGlucHV0VGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0X3R5cGVfYWJvdXQtbWVcIik7XHJcbmV4cG9ydCBjb25zdCBwbGFjZUZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fdHlwZV9wbGFjZVwiKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhckZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fdHlwZV9hdmF0YXJcIik7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1jb250YWluZXJcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKTtcclxuZXhwb3J0IGNvbnN0IHRyYXNoSWNvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9fdHJhc2gtYnRuXCIpO1xyXG4vL2V4cG9ydCBjb25zdCBwcm9maWxlQ2xvc2VCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4vLyAgXCIubW9kYWxfX2Nsb3NlLWJ0bl90eXBlX3Byb2ZpbGVcIlxyXG4vLyk7XHJcbi8vZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xyXG4vL2V4cG9ydCBjb25zdCBwcm9maWxlQWJvdXRNZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWJvdXQtbWVcIik7XHJcblxyXG4vL2V4cG9ydCBjb25zdCBwbGFjZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF90eXBlX3BsYWNlXCIpO1xyXG4vL2V4cG9ydCBjb25zdCBwbGFjZUNsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuLy8gIFwiLm1vZGFsX19jbG9zZS1idG5fdHlwZV9wbGFjZVwiXHJcbi8vKTtcclxuLy9jb25zdCBwbGFjZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5mb3JtX19pbnB1dF90eXBlX3RpdGxlXCIpO1xyXG4vL2NvbnN0IHBsYWNlTGluayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9faW5wdXRfdHlwZV9pbWFnZS1saW5rXCIpO1xyXG4vL2V4cG9ydCBjb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX3R5cGVfcHJldmlld1wiKTtcclxuLy9leHBvcnQgY29uc3QgcHJldmlld0Nsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuLy8gXCIubW9kYWxfX2Nsb3NlLWJ0bl90eXBlX3ByZXZpZXdcIlxyXG4vLyk7XHJcbi8vZXhwb3J0IGNvbnN0IHByZXZpZXdUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbi8vICBcIi5tb2RhbF9fdGl0bGVfdHlwZV9wcmV2aWV3XCJcclxuLy8pO1xyXG4vL2V4cG9ydCBjb25zdCBwcmV2aWV3SW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4vLyBcIi5tb2RhbF9faW1hZ2VfdHlwZV9wcmV2aWV3XCJcclxuLy8pO1xyXG5cclxuLy9leHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4vLyB7XHJcbi8vICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuLy8gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS95b3NlbWl0ZS5qcGdcIixcclxuLy8gIH0sXHJcbi8vICB7XHJcbi8vICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuLy8gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIixcclxuLy8gIH0sXHJcbi8vICB7XHJcbi8vICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuLy8gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9iYWxkLW1vdW50YWlucy5qcGdcIixcclxuLy8gIH0sXHJcbi8vICB7XHJcbi8vICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxyXG4vLyAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhdGVtYXIuanBnXCIsXHJcbi8vICB9LFxyXG4vLyAge1xyXG4vLyAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4vLyAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3Zhbm9pc2UuanBnXCIsXHJcbi8vICB9LFxyXG4vLyAge1xyXG4vLyAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbi8vICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFnby5qcGdcIixcclxuLy8gIH0sXHJcbi8vXTtcclxuIiwiXHJcblxyXG5leHBvcnQgY2xhc3MgQXBpIHtcclxuICAgIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICAgIH1cclxuXHJcbiAgICBfY3VzdG9tRmV0Y2ggPSAodXJsLCBoZWFkZXJzKSA9PlxyXG4gICAgZmV0Y2godXJsLCBoZWFkZXJzKVxyXG4gICAgICAudGhlbigocmVzKSA9PiAocmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KHJlcy5zdGF0dXNUZXh0KSkpXHJcbiAgICAgIC8vLmNhdGNoKGNvbnNvbGUubG9nKTtcclxuICBcclxuICAgIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICBcclxuICAgIGVkaXRQcm9maWxlKG5hbWUsIGFib3V0KSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgYWJvdXRcclxuICAgICAgICAgIH0pXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGVkaXRBdmF0YXIodXJsKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICBhdmF0YXI6IHVybCxcclxuICAgICAgICAgICAgfSkgIFxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gIFxyXG4gIFxyXG4gICAgY3JlYXRlQ2FyZHMoZGF0YSkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICBcclxuICAgIGRlbGV0ZUNhcmRzKGNhcmRJZCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fY3VzdG9tRmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICBcclxuICAgIGFkZExpa2UoY2FyZElkKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9jdXN0b21GZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgcmVtb3ZlTGlrZShjYXJkSWQpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2N1c3RvbUZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzL2xpa2VzLyR7Y2FyZElkfWAsIHtcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gIH1cclxuICBcclxuICBleHBvcnQgY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvY29ob3J0LTMtZW5cIixcclxuICAgIGhlYWRlcnM6IHtcclxuICAgICAgYXV0aG9yaXphdGlvbjogXCJhNDJiMTExNS1jNzI4LTRlZDAtYWMyNi0zZDNhMmNkOGU5NWRcIixcclxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICB9LFxyXG4gIH0pO1xyXG4gIFxyXG4gIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuXHJcbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2VcIjtcclxuaW1wb3J0IHsgUG9wdXBXaXRoRm9ybSB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm1cIjtcclxuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mb1wiO1xyXG5pbXBvcnQgeyBTZWN0aW9uIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvblwiO1xyXG5pbXBvcnQgeyBDYXJkIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZFwiO1xyXG5cclxuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IHtcclxuICBhdmF0YXIsXHJcbiAgcHJvZmlsZUZvcm0sXHJcbiAgZWRpdFByb2ZpbGVCdXR0b24sXHJcbiAgYWRkUHJvZmlsZUJ1dHRvbixcclxuICBpbnB1dE5hbWUsXHJcbiAgaW5wdXRUaXRsZSxcclxuICBwbGFjZUZvcm0sXHJcbiAgY2FyZFRlbXBsYXRlU2VsZWN0b3IsXHJcbiAgc2V0dGluZ3MsXHJcbiAgYXZhdGFyRm9ybSxcclxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCB7IFBvcHVwV2l0aENvbmZpcm1hdGlvbiB9IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvblwiO1xyXG5pbXBvcnQgeyBhcGkgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGlcIjtcclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9wcm9maWxlLW1vZGFsLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbmNvbnN0IHByb2ZpbGVNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLm1vZGFsX3R5cGVfZWRpdC1wcm9maWxlXCIsIChkYXRhKSA9PiB7XHJcbiAgcHJvZmlsZU1vZGFsLnJlbmRlckxvYWRpbmcodHJ1ZSwgXCJzYXZpbmcuLi5cIik7XHJcbiAgYXBpXHJcbiAgICAuZWRpdFByb2ZpbGUoZGF0YS51c2VyLCBkYXRhW1wiYWJvdXRcIl0pXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHJlcy5uYW1lLCByZXNbXCJhYm91dFwiXSk7XHJcbiAgICAgIHByb2ZpbGVNb2RhbC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4gcHJvZmlsZU1vZGFsLnJlbmRlckxvYWRpbmcoZmFsc2UpKTtcclxufSk7XHJcbnByb2ZpbGVNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL3BsYWNlLW1vZGFsLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbmNvbnN0IHBsYWNlTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5tb2RhbF90eXBlX3BsYWNlXCIsIChkYXRhKSA9PiB7XHJcbiAgcGxhY2VNb2RhbC5yZW5kZXJMb2FkaW5nKHRydWUsIFwiQ3JlYXRpbmcuLi5cIik7XHJcbiAgYXBpXHJcbiAgICAuY3JlYXRlQ2FyZHMoeyBuYW1lOiBkYXRhW1wiVGl0bGVcIl0sIGxpbms6IGRhdGFbXCJJbWFnZSBsaW5rXCJdIH0pXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIC8vZ2VuZXJhdGVDYXJkKHJlcyk7XHJcbiAgICAgIHJlbmRlckNhcmQocmVzKTtcclxuICAgICAgcGxhY2VNb2RhbC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4gcGxhY2VNb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKSk7XHJcbn0pO1xyXG5cclxucGxhY2VNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9hdmF0YXItbW9kYWwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuY29uc3QgYXZhdGFyTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5tb2RhbF90eXBlX2F2YXRhclwiLCAoZGF0YSkgPT4ge1xyXG4gIGF2YXRhck1vZGFsLnJlbmRlckxvYWRpbmcodHJ1ZSwgXCJzYXZpbmcuLi5cIik7XHJcbiAgYXBpXHJcbiAgICAuZWRpdEF2YXRhcihkYXRhW1wiSW1hZ2UgbGlua1wiXSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgdXNlckluZm8uc2V0QXZhdGFySW5mbyhyZXMuYXZhdGFyKTtcclxuICAgICAgYXZhdGFyTW9kYWwuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgIC5maW5hbGx5KCgpID0+IGF2YXRhck1vZGFsLnJlbmRlckxvYWRpbmcoZmFsc2UpKTtcclxufSk7XHJcbmF2YXRhck1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL3ByZXZpZXctbW9kYWwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuY29uc3QgcHJldmlld01vZGFsID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiLm1vZGFsX3R5cGVfcHJldmlld1wiKTtcclxucHJldmlld01vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9kZWxldGUtbW9kYWwvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbmNvbnN0IGRlbGV0ZU1vZGFsID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbihcIi5tb2RhbF90eXBlX2RlbGV0ZVwiKTtcclxuZGVsZXRlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vY2FyZCBjcmVhdGUgKyBhcGkgY29ubmVjdGlvbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG5sZXQgdXNlcklkO1xyXG5cclxuUHJvbWlzZS5hbGwoW2FwaS5nZXRJbml0aWFsQ2FyZHMoKSwgYXBpLmdldFVzZXJJbmZvKCldKS50aGVuKFxyXG4gIChbY2FyZERhdGEsIHVzZXJEYXRhXSkgPT4ge1xyXG4gICAgdXNlcklkID0gdXNlckRhdGEuX2lkO1xyXG5cclxuICAgIHByZXZpZXdTZWN0aW9uLnJlbmRlcihjYXJkRGF0YSk7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YS5uYW1lLCB1c2VyRGF0YS5hYm91dCk7XHJcbiAgICB1c2VySW5mby5zZXRBdmF0YXJJbmZvKHVzZXJEYXRhLmF2YXRhcik7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcblxyXG5cclxuY29uc3QgcHJldmlld1NlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICB7XHJcbiAgICByZW5kZXJlcjogcmVuZGVyQ2FyZCxcclxuICB9LFxyXG4gIFwiLmVsZW1lbnRfX2xpc3RcIlxyXG4pO1xyXG5cclxuZnVuY3Rpb24gZ2VuZXJhdGVDYXJkKGRhdGEpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICBkYXRhLFxyXG4gICAgY2FyZFRlbXBsYXRlU2VsZWN0b3IsXHJcbiAgICAoKSA9PiB7XHJcbiAgICAgIHByZXZpZXdNb2RhbC5vcGVuKGRhdGEubGluaywgZGF0YS5uYW1lKTtcclxuICAgIH0sXHJcbiAgICAoaWQpID0+IHtcclxuICAgICAgZGVsZXRlTW9kYWwub3BlbigpO1xyXG4gICAgICBkZWxldGVNb2RhbC5zZXRBY3Rpb24oKCkgPT4ge1xyXG4gICAgICAgIGFwaS5kZWxldGVDYXJkcyhpZCkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICBjYXJkLnJlbW92ZUNhcmQoKTtcclxuICAgICAgICAgIGRlbGV0ZU1vZGFsLmNsb3NlKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgICgpID0+IHtcclxuICAgICAgaWYgKGNhcmQuaXNMaWtlZCgpKSB7XHJcbiAgICAgICAgYXBpLnJlbW92ZUxpa2UoY2FyZC5nZXRJZCgpKS50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgIGNhcmQuc2V0TGlrZXMocmVzLmxpa2VzKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBhcGkuYWRkTGlrZShjYXJkLmdldElkKCkpLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgY2FyZC5zZXRMaWtlcyhyZXMubGlrZXMpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgdXNlcklkXHJcbiAgKTtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuZ2VuZXJhdGVDYXJkKGRhdGEpO1xyXG4gIHJldHVybiBjYXJkRWxlbWVudDtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVuZGVyQ2FyZChkYXRhKSB7XHJcbiAgY29uc3QgZWxlbWVudCA9IGdlbmVyYXRlQ2FyZChkYXRhKTtcclxuICBwcmV2aWV3U2VjdGlvbi5hZGRJdGVtKGVsZW1lbnQpO1xyXG59XHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vdmFsaWRhdGlvbiAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBwcm9maWxlRm9ybSk7XHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBwbGFjZUZvcm0pO1xyXG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3Ioc2V0dGluZ3MsIGF2YXRhckZvcm0pO1xyXG5cclxuYWRkQ2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmF2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fbmFtZVwiLFxyXG4gIGpvYlNlbGVjdG9yOiBcIi5wcm9maWxlX19hYm91dFwiLFxyXG4gIGF2YXRhclNlbGVjdG9yOiBcIi5wcm9maWxlX19hdmF0YXJcIixcclxufSk7XHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vRXZlbnQgTGlzdGVuZXJzLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbmVkaXRQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY29uc3QgaW5mbyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgaW5wdXROYW1lLnZhbHVlID0gaW5mby5uYW1lO1xyXG4gIGlucHV0VGl0bGUudmFsdWUgPSBpbmZvLmpvYjtcclxuICBlZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVCdXR0b24oKTtcclxuICBlZGl0Rm9ybVZhbGlkYXRvci5oaWRlRXJyb3JzKCk7XHJcbiAgcHJvZmlsZU1vZGFsLm9wZW4oKTtcclxufSk7XHJcblxyXG5hZGRQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgcGxhY2VNb2RhbC5vcGVuKCk7XHJcbiAgYWRkQ2FyZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgYWRkQ2FyZEZvcm1WYWxpZGF0b3IuaGlkZUVycm9ycygpO1xyXG59KTtcclxuXHJcbmF2YXRhci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGF2YXRhck1vZGFsLm9wZW4oKTtcclxuICBhdmF0YXJGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGF2YXRhckZvcm1WYWxpZGF0b3IuaGlkZUVycm9ycygpO1xyXG59KTtcclxuIiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faW1hZ2VFbGVtYW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLm1vZGFsX19pbWFnZV90eXBlX3ByZXZpZXdcIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX2ltYWdlQ2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5tb2RhbF9fdGl0bGVfdHlwZV9wcmV2aWV3XCJcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBvcGVuKGltYWdlLCBjYXB0aW9uKSB7XHJcbiAgICB0aGlzLl9pbWFnZUVsZW1hbnQuc3JjID0gaW1hZ2U7XHJcbiAgICB0aGlzLl9pbWFnZUVsZW1hbnQuYWx0ID0gYEEgYmVhdXRpZnVsIHZpZXcgb2YgJHtjYXB0aW9ufWA7XHJcbiAgICB0aGlzLl9pbWFnZUNhcHRpb24udGV4dENvbnRlbnQgPSBjYXB0aW9uO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xyXG4gIHNldEFjdGlvbihhY3Rpb24pIHtcclxuICAgIHRoaXMuX3N1Ym1pdEhhbmRsZXIgPSBhY3Rpb247XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5fc3VibWl0SGFuZGxlcigpO1xyXG4gICAgfSk7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgLy9yZW5kZXJpbmcgYSBsaXN0IG9mIGVsZW1lbnRzIG9uIGEgcGFnZVxyXG4gIGNvbnN0cnVjdG9yKHsgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7IC8vIHJlc3BvbnNpYmxlIGZvciBjcmVhdGluZyBhbmQgcmVuZGVyaW5nIGRhdGEgb24gYSBwYWdlLlxyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7IC8vQ1NTIGNsYXNzIHNlbGVjdG9yIHRvICBhZGQgdGhlIGNhcmQgZWxlbWVudHMuXHJcbiAgfVxyXG5cclxuICByZW5kZXIoaXRlbXMpIHtcclxuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oaXRlbSkge1xyXG4gICAgLy9wdWJsaWMgbWV0aG9kIHRoYXQgdGFrZXMgdGhlIGl0ZW1zIGFuZCByZW5kZXIgdGhlbSBpbnRvIHRoZSBjb250YWluZXIuXHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChpdGVtKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX3Byb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcHJvZmlsZUpvYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fYXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50LFxyXG4gICAgICBqb2I6IHRoaXMuX3Byb2ZpbGVKb2IudGV4dENvbnRlbnQsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8obmFtZSwgam9iKSB7XHJcbiAgICB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9wcm9maWxlSm9iLnRleHRDb250ZW50ID0gam9iO1xyXG4gIH1cclxuXHJcbiAgc2V0QXZhdGFySW5mbyhhdmF0YXIpIHtcclxuICAgIHRoaXMuX2F2YXRhci5zcmMgPSBhdmF0YXI7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJQb3B1cCIsImNvbnN0cnVjdG9yIiwicG9wdXBTZWxlY3RvciIsImV2dCIsImtleSIsInRoaXMiLCJjbG9zZSIsInRhcmdldCIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwiX3BvcHVwRWxlbWVudCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImJpbmQiLCJvcGVuIiwiYWRkIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVPdmVybGF5Q2xvc2UiLCJfaGFuZGxlRXNjQ2xvc2UiLCJyZW1vdmUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJQb3B1cFdpdGhGb3JtIiwic3VibWl0SGFuZGxlciIsInN1cGVyIiwiX2Zvcm1FbGVtZW50IiwicmVzZXQiLCJfaW5wdXRMaXN0IiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRIYW5kbGVyIiwiX3N1Ym1pdEJ1dHRvbiIsIl9zdWJtaXRCdXR0b25UZXh0IiwidGV4dENvbnRlbnQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsImZvckVhY2giLCJpbnB1dCIsIm5hbWUiLCJ2YWx1ZSIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJsb2FkaW5nVGV4dCIsImUiLCJwcmV2ZW50RGVmYXVsdCIsIkNhcmQiLCJkYXRhIiwic2VsZWN0b3IiLCJoYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVEZWxldGVDYXJkIiwiaGFuZGxlTGlrZUljb24iLCJ1c2VySWQiLCJfc2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3RleHQiLCJfbGluayIsImxpbmsiLCJfaGFuZGxlQ2FyZENsaWNrIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJfaGFuZGxlTGlrZUljb24iLCJfaWQiLCJfdXNlcklkIiwiX293bmVySWQiLCJvd25lciIsIl9saWtlcyIsImxpa2VzIiwiX2xpa2VDb3VudCIsImdldElkIiwicmVtb3ZlQ2FyZCIsIl9lbGVtZW50IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2xpa2VCdXR0b24iLCJfZGVsZXRlQnV0dG9uIiwiX2ltYWdlIiwic2V0TGlrZXMiLCJuZXdMaWtlcyIsImxpa2VBbW91bnQiLCJsZW5ndGgiLCJpc0xpa2VkIiwiZmluZCIsInVzZXIiLCJnZW5lcmF0ZUNhcmQiLCJfZ2V0VGVtcGxhdGVDbG9uZSIsInNyYyIsImFsdCIsInN0eWxlIiwiZGlzcGxheSIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiX2Zvcm0iLCJpZCIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInNvbWUiLCJfYnV0dG9uIiwiZGlzYWJsZWQiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9oYXNJbnZhbGlkSW5wdXRzIiwiX2Rpc2FibGVCdXR0b24iLCJlbmFibGVCdXR0b24iLCJBcnJheSIsImZyb20iLCJfaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsIl90b2dnbGVCdXR0b24iLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJyZXNldFZhbGlkYXRpb24iLCJlbmFibGVWYWxpZGF0aW9uIiwiaGlkZUVycm9ycyIsInByb2ZpbGVGb3JtIiwiZWRpdFByb2ZpbGVCdXR0b24iLCJhZGRQcm9maWxlQnV0dG9uIiwiaW5wdXROYW1lIiwiaW5wdXRUaXRsZSIsInBsYWNlRm9ybSIsImF2YXRhckZvcm0iLCJhdmF0YXIiLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsInVybCIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXNUZXh0IiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldEluaXRpYWxDYXJkcyIsIl9jdXN0b21GZXRjaCIsImdldFVzZXJJbmZvIiwiZWRpdFByb2ZpbGUiLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZWRpdEF2YXRhciIsImNyZWF0ZUNhcmRzIiwiZGVsZXRlQ2FyZHMiLCJjYXJkSWQiLCJhZGRMaWtlIiwicmVtb3ZlTGlrZSIsImF1dGhvcml6YXRpb24iLCJwcm9maWxlTW9kYWwiLCJ1c2VySW5mbyIsInNldFVzZXJJbmZvIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiZmluYWxseSIsInBsYWNlTW9kYWwiLCJyZW5kZXJDYXJkIiwiYXZhdGFyTW9kYWwiLCJzZXRBdmF0YXJJbmZvIiwicHJldmlld01vZGFsIiwiX2ltYWdlRWxlbWFudCIsIl9pbWFnZUNhcHRpb24iLCJpbWFnZSIsImNhcHRpb24iLCJkZWxldGVNb2RhbCIsInNldEFjdGlvbiIsImFjdGlvbiIsImFsbCIsImNhcmREYXRhIiwidXNlckRhdGEiLCJwcmV2aWV3U2VjdGlvbiIsInJlbmRlciIsImNvbnRhaW5lclNlbGVjdG9yIiwicmVuZGVyZXIiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiaXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsInByZXBlbmQiLCJlbGVtZW50IiwiY2FyZCIsImVkaXRGb3JtVmFsaWRhdG9yIiwiYWRkQ2FyZEZvcm1WYWxpZGF0b3IiLCJhdmF0YXJGb3JtVmFsaWRhdG9yIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9wcm9maWxlTmFtZSIsIl9wcm9maWxlSm9iIiwiX2F2YXRhciIsImpvYiIsImluZm8iXSwic291cmNlUm9vdCI6IiJ9